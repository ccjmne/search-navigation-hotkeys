// ==UserScript==
// @name Google Search Hotkeys
// @version 1.0.0
// @description Navigate results from Google searches without ever lifting your hands off the keyboard!
// @author Eric NICOLAS <ccjmne@gmail.com> (https://github.com/ccjmne)
// @namespace https://github.com/ccjmne/google-search-hotkeys#readme
// @include *://www.google.tld/search*
// @downloadURL https://github.com/ccjmne/google-search-hotkeys/master/dist/main.js
// @grant none
// ==/UserScript==
(function(a){function b(d){if(c[d])return c[d].exports;var e=c[d]={i:d,l:!1,exports:{}};return a[d].call(e.exports,e,e.exports,b),e.l=!0,e.exports}var c={};return b.m=a,b.c=c,b.d=function(a,c,d){b.o(a,c)||Object.defineProperty(a,c,{enumerable:!0,get:d})},b.r=function(a){'undefined'!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(a,Symbol.toStringTag,{value:'Module'}),Object.defineProperty(a,'__esModule',{value:!0})},b.t=function(a,c){if(1&c&&(a=b(a)),8&c)return a;if(4&c&&'object'==typeof a&&a&&a.__esModule)return a;var d=Object.create(null);if(b.r(d),Object.defineProperty(d,'default',{enumerable:!0,value:a}),2&c&&'string'!=typeof a)for(var e in a)b.d(d,e,function(b){return a[b]}.bind(null,e));return d},b.n=function(a){var c=a&&a.__esModule?function(){return a['default']}:function(){return a};return b.d(c,'a',c),c},b.o=function(a,b){return Object.prototype.hasOwnProperty.call(a,b)},b.p='',b(b.s=7)})([function(a){'use strict';a.exports=function(a){var b=1<arguments.length&&arguments[1]!==void 0?arguments[1]:0,c=0;return function(){var d=new Date().getTime();if(d-c>=b)return c=d,a.apply(void 0,arguments)}}},function(a){'use strict';a.exports=function(a){return new Promise(function(b){var c=setInterval(function(){0<document.querySelectorAll(a).length&&(clearInterval(c),b(document.querySelectorAll(a)))},100)})}},function(a,b,c){var d=c(3);'string'==typeof d&&(d=[[a.i,d,'']]);var e,f={hmr:!0};f.transform=e,f.insertInto=void 0;c(5)(d,f);d.locals&&(a.exports=d.locals),!1},function(a,b,c){b=a.exports=c(4)(!1),b.push([a.i,'#ccjmne--google-search-hotkeys--indicator,.ccjmne--google-search-hotkeys--number-indicator{cursor:help}#ccjmne--google-search-hotkeys--indicator{position:absolute;left:-1.5em;color:crimson;font-size:18px}#ccjmne--google-search-hotkeys--indicator::before{content:\'\\25B6\'}.ccjmne--google-search-hotkeys--number-indicator{position:absolute;left:-1.5em;transform:translate(-100%, 20%);font-family:monospace}#ccjmne--google-search-hotkeys--indicator+.ccjmne--google-search-hotkeys--number-indicator{display:none}#ccjmne--google-search-hotkeys--tooltip{display:flex;position:absolute;top:0;left:-.5em;align-items:center;height:30px;padding:0 1em;transition:box-shadow 0.2s ease-out;border:1px solid #708090;border-radius:10px 0 10px 10px;background-color:#fff;color:#708090;font-family:sans-serif;font-size:13px;white-space:nowrap}#ccjmne--google-search-hotkeys--tooltip::before{content:"What\'s this?"}#ccjmne--google-search-hotkeys--tooltip:active,#ccjmne--google-search-hotkeys--tooltip:hover{border-color:#434d57;box-shadow:0 1px 3px rgba(0, 0, 0, .12), 0 1px 2px rgba(0, 0, 0, .24);color:#434d57;cursor:pointer}#ccjmne--google-search-hotkeys--tooltip:active{background-color:#f8f8ff}#ccjmne--google-search-hotkeys--backdrop{display:flex;position:fixed;z-index:999;top:0;right:0;bottom:0;left:0;align-items:center;justify-content:center;perspective:1000px;background-color:rgba(0,0,0,0.35)}#ccjmne--google-search-hotkeys--tilt-origin{transform-style:preserve-3d;transition:transform 0.2s ease-out}#ccjmne--google-search-hotkeys--tilt-origin:hover #ccjmne--google-search-hotkeys--help-shadow{opacity:.5}#ccjmne--google-search-hotkeys--tilt-origin:hover #ccjmne--google-search-hotkeys--help-card{box-shadow:0 14px 28px rgba(0, 0, 0, .25), 0 10px 10px rgba(0, 0, 0, .22)}#ccjmne--google-search-hotkeys--help-shadow{position:absolute;top:0;right:0;bottom:0;left:0;transform:scale(1.7) translateZ(-650px);transition:opacity 0.2s ease-out;border-radius:5px;opacity:0;background-color:#708090}#ccjmne--google-search-hotkeys--help-card-container{perspective:2000px}#ccjmne--google-search-hotkeys--help-card-container #ccjmne--google-search-hotkeys--help-card{overflow:hidden;transition:box-shadow 0.2s ease-out;border-radius:3px;background-color:#f8f8ff;box-shadow:0 3px 6px rgba(0, 0, 0, .16), 0 3px 6px rgba(0, 0, 0, .23);color:#444;font-size:16px}#ccjmne--google-search-hotkeys--help-card-title{display:flex;align-items:center;justify-content:space-evenly;padding:2vh 2vw;border-bottom:1px solid crimson;background-color:#708090;color:#f8f8ff;font-size:18px}#ccjmne--google-search-hotkeys--help-card a,#ccjmne--google-search-hotkeys--help-card a:visited{color:#f8f8ff}#ccjmne--google-search-hotkeys--help-card em{color:crimson;font-weight:normal}#ccjmne--google-search-hotkeys--help-card kbd{display:inline-block;padding:0.2em 0.5em;border:1px solid #aaa;border-radius:3px;background-color:#f8f8ff;box-shadow:0 1px 0 #aaa;font-family:monospace;white-space:nowrap;cursor:default}#ccjmne--google-search-hotkeys--help-card kbd:empty{display:none}#ccjmne--google-search-hotkeys--help-card table{border-collapse:collapse}#ccjmne--google-search-hotkeys--help-card table:last-child tr:last-child td{border-bottom:2vh solid #f8f8ff}#ccjmne--google-search-hotkeys--help-card table tr:nth-child(2n){background-color:rgba(0,0,0,0.1)}#ccjmne--google-search-hotkeys--help-card table tr:hover{background-color:rgba(112,128,144,0.5);color:#000}#ccjmne--google-search-hotkeys--help-card table tr:hover kbd{color:crimson}#ccjmne--google-search-hotkeys--help-card table tr.ccjmne--google-search-hotkeys--new-section td{border-top:2vh solid #f8f8ff}#ccjmne--google-search-hotkeys--help-card table tr td{padding:0.2em 0 0.2em 2vw;white-space:nowrap}#ccjmne--google-search-hotkeys--help-card table tr td:last-child{padding-right:2vw;text-align:right}\n',''])},function(a){function b(a,b){var d=a[1]||'',e=a[3];if(!e)return d;if(b&&'function'==typeof btoa){var f=c(e),g=e.sources.map(function(a){return'/*# sourceURL='+e.sourceRoot+a+' */'});return[d].concat(g).concat([f]).join('\n')}return[d].join('\n')}function c(a){var b=btoa(unescape(encodeURIComponent(JSON.stringify(a))));return'/*# '+('sourceMappingURL=data:application/json;charset=utf-8;base64,'+b)+' */'}a.exports=function(a){var c=[];return c.toString=function(){return this.map(function(c){var d=b(c,a);return c[2]?'@media '+c[2]+'{'+d+'}':d}).join('')},c.i=function(a,b){'string'==typeof a&&(a=[[null,a,'']]);for(var d,e={},f=0;f<this.length;f++)d=this[f][0],'number'==typeof d&&(e[d]=!0);for(f=0;f<a.length;f++){var g=a[f];'number'==typeof g[0]&&e[g[0]]||(b&&!g[2]?g[2]=b:b&&(g[2]='('+g[2]+') and ('+b+')'),c.push(g))}},c}},function(a,b,c){function d(a,b){for(var c=0;c<a.length;c++){var d=a[c],e=p[d.id];if(e){e.refs++;for(var f=0;f<e.parts.length;f++)e.parts[f](d.parts[f]);for(;f<d.parts.length;f++)e.parts.push(l(d.parts[f],b))}else{for(var g=[],f=0;f<d.parts.length;f++)g.push(l(d.parts[f],b));p[d.id]={id:d.id,refs:1,parts:g}}}}function e(a,b){for(var c=[],d={},e=0;e<a.length;e++){var f=a[e],g=b.base?f[0]+b.base:f[0],h=f[1],i=f[2],j=f[3],k={css:h,media:i,sourceMap:j};d[g]?d[g].parts.push(k):c.push(d[g]={id:g,parts:[k]})}return c}function f(a,b){var c=s(a.insertInto);if(!c)throw new Error('Couldn\'t find a style target. This probably means that the value for the \'insertInto\' parameter is invalid.');var d=v[v.length-1];if('top'===a.insertAt)d?d.nextSibling?c.insertBefore(b,d.nextSibling):c.appendChild(b):c.insertBefore(b,c.firstChild),v.push(b);else if('bottom'===a.insertAt)c.appendChild(b);else if('object'==typeof a.insertAt&&a.insertAt.before){var e=s(a.insertAt.before,c);c.insertBefore(b,e)}else throw new Error('[Style Loader]\n\n Invalid value for parameter \'insertAt\' (\'options.insertAt\') found.\n Must be \'top\', \'bottom\', or Object.\n (https://github.com/webpack-contrib/style-loader#insertat)\n')}function g(a){if(null===a.parentNode)return!1;a.parentNode.removeChild(a);var b=v.indexOf(a);0<=b&&v.splice(b,1)}function h(a){var b=document.createElement('style');if(void 0===a.attrs.type&&(a.attrs.type='text/css'),void 0===a.attrs.nonce){var c=k();c&&(a.attrs.nonce=c)}return j(b,a.attrs),f(a,b),b}function i(a){var b=document.createElement('link');return void 0===a.attrs.type&&(a.attrs.type='text/css'),a.attrs.rel='stylesheet',j(b,a.attrs),f(a,b),b}function j(a,b){Object.keys(b).forEach(function(c){a.setAttribute(c,b[c])})}function k(){return!1,c.nc}function l(a,b){var c,d,e,f;if(b.transform&&a.css)if(f=b.transform(a.css),f)a.css=f;else return function(){};if(b.singleton){var j=u++;c=t||(t=h(b)),d=m.bind(null,c,j,!1),e=m.bind(null,c,j,!0)}else a.sourceMap&&'function'==typeof URL&&'function'==typeof URL.createObjectURL&&'function'==typeof URL.revokeObjectURL&&'function'==typeof Blob&&'function'==typeof btoa?(c=i(b),d=o.bind(null,c,b),e=function(){g(c),c.href&&URL.revokeObjectURL(c.href)}):(c=h(b),d=n.bind(null,c),e=function(){g(c)});return d(a),function(b){if(b){if(b.css===a.css&&b.media===a.media&&b.sourceMap===a.sourceMap)return;d(a=b)}else e()}}function m(a,b,c,d){var e=c?'':d.css;if(a.styleSheet)a.styleSheet.cssText=x(b,e);else{var f=document.createTextNode(e),g=a.childNodes;g[b]&&a.removeChild(g[b]),g.length?a.insertBefore(f,g[b]):a.appendChild(f)}}function n(a,b){var c=b.css,d=b.media;if(d&&a.setAttribute('media',d),a.styleSheet)a.styleSheet.cssText=c;else{for(;a.firstChild;)a.removeChild(a.firstChild);a.appendChild(document.createTextNode(c))}}function o(a,b,c){var d=c.css,e=c.sourceMap,f=b.convertToAbsoluteUrls===void 0&&e;(b.convertToAbsoluteUrls||f)&&(d=w(d)),e&&(d+='\n/*# sourceMappingURL=data:application/json;base64,'+btoa(unescape(encodeURIComponent(JSON.stringify(e))))+' */');var g=new Blob([d],{type:'text/css'}),h=a.href;a.href=URL.createObjectURL(g),h&&URL.revokeObjectURL(h)}var p={},q=function(a){var b;return function(){return'undefined'==typeof b&&(b=a.apply(this,arguments)),b}}(function(){return window&&document&&document.all&&!window.atob}),r=function(a,b){return b?b.querySelector(a):document.querySelector(a)},s=function(){var a={};return function(b,c){if('function'==typeof b)return b();if('undefined'==typeof a[b]){var d=r.call(this,b,c);if(window.HTMLIFrameElement&&d instanceof window.HTMLIFrameElement)try{d=d.contentDocument.head}catch(a){d=null}a[b]=d}return a[b]}}(),t=null,u=0,v=[],w=c(6);a.exports=function(a,b){if('undefined'!=typeof DEBUG&&DEBUG&&'object'!=typeof document)throw new Error('The style-loader cannot be used in a non-browser environment');b=b||{},b.attrs='object'==typeof b.attrs?b.attrs:{},b.singleton||'boolean'==typeof b.singleton||(b.singleton=q()),b.insertInto||(b.insertInto='head'),b.insertAt||(b.insertAt='bottom');var c=e(a,b);return d(c,b),function(a){for(var f=[],g=0;g<c.length;g++){var h=c[g],i=p[h.id];i.refs--,f.push(i)}if(a){var k=e(a,b);d(k,b)}for(var i,g=0;g<f.length;g++)if(i=f[g],0===i.refs){for(var l=0;l<i.parts.length;l++)i.parts[l]();delete p[i.id]}}};var x=function(){var a=[];return function(b,c){return a[b]=c,a.filter(Boolean).join('\n')}}()},function(a){a.exports=function(a){var b='undefined'!=typeof window&&window.location;if(!b)throw new Error('fixUrls requires window.location');if(!a||'string'!=typeof a)return a;var c=b.protocol+'//'+b.host,d=c+b.pathname.replace(/\/[^\/]*$/,'/'),e=a.replace(/url\s*\(((?:[^)(]|\((?:[^)(]+|\([^)(]*\))*\))*)\)/gi,function(a,b){var e=b.trim().replace(/^"(.*)"$/,function(a,b){return b}).replace(/^'(.*)'$/,function(a,b){return b});if(/^(#|data:|http:\/\/|https:\/\/|file:\/\/\/|\s*$)/i.test(e))return a;var f;return f=0===e.indexOf('//')?e:0===e.indexOf('/')?c+e:d+e.replace(/^\.\//,''),'url('+JSON.stringify(f)+')'});return e}},function(a,b,c){'use strict';function d(a,b){return function(c){var d=c.indexOf('#'),e=-1===d?'':c.substr(d);c=-1===d?c:c.substr(0,d);var f=new RegExp('([?&])'+a+'=.*?(&|$)','i'),g=-1===c.indexOf('?')?'?':'&';return c=c.match(f)?c.replace(f,'$1'+a+'='+b+'$2'):c+g+a+'='+b,c+e}(window.location.href)}function f(a){return(window.location.search.match(new RegExp('(?<=[&?]'.concat(a,'=)[^&]*')))||[])[0]}function g(a){return i(a)||h(a)||e()}function e(){throw new TypeError('Invalid attempt to spread non-iterable instance')}function h(a){if(Symbol.iterator in Object(a)||'[object Arguments]'===Object.prototype.toString.call(a))return Array.from(a)}function i(a){if(Array.isArray(a)){for(var b=0,c=Array(a.length);b<a.length;b++)c[b]=a[b];return c}}function j(a){a.parentNode&&a.parentNode.removeChild(a)}function k(a){var b,c=a.type,d=void 0===c?'div':c,f=a.id,h=void 0===f?'':f,i=a.classes,k=void 0===i?[]:i,l=a.contents,m=void 0===l?'':l,n=document.createElement(d);return n.id=h,(b=n.classList).add.apply(b,g(k)),n.innerHTML=m,n.detach=j.bind(n,n),n}function l(a){a&&!A.parentNode?(document.body.prepend(A),A.animate({opacity:[0,1]},{duration:200,easing:'ease-out'}),z.animate({transform:['translateY(-50%) rotateX(80deg)','translateY(2%) rotateX(0)','translateY(0)'],opacity:[0,1,1],offset:[0,.8]},{duration:300,delay:100,easing:'ease-out',fill:'backwards'})):!a&&A.parentNode&&(B.style.transform='',A.animate({opacity:[1,0]},{duration:200,easing:'ease-out'}).onfinish=A.detach,z.animate({transform:['scale(1)','scale(1.1)','scale(.5)']},{duration:200,easing:'ease-out'}))}function m(a,b,c){return b in a?Object.defineProperty(a,b,{value:c,enumerable:!0,configurable:!0,writable:!0}):a[b]=c,a}function n(a){return q(a)||p(a)||o()}function o(){throw new TypeError('Invalid attempt to spread non-iterable instance')}function p(a){if(Symbol.iterator in Object(a)||'[object Arguments]'===Object.prototype.toString.call(a))return Array.from(a)}function q(a){if(Array.isArray(a)){for(var b=0,c=Array(a.length);b<a.length;b++)c[b]=a[b];return c}}var r=Math.max;c.r(b);var s=c(0),t=c.n(s),u=c(1),v=c.n(u),w=k({id:'ccjmne--google-search-hotkeys--tooltip'});Object.assign(w,{concealTimer:null,reveal:function(a){w.parentNode!==a.target&&(clearTimeout(w.concealTimer),a.target.appendChild(w),w.concealTimer=setTimeout(w.conceal,3e3),w.animate({transform:['translate(-50%, 0) scale(0)','translate(-100%, 1em) scale(1.1)','translate(-100%, 1em) scale(1)'],offset:[0,.8]},{duration:200,easing:'ease-out',fill:'both'}))},conceal:function(){return(w.animate({transform:['translate(-100%, 1em) scale(1)','translate(-100%, 1em) scale(1.1)','translate(-100%, 1em) scale(.5)'],opacity:[1,1,0],offset:[0,.3]},{duration:200,easing:'ease-in',fill:'backwards'}).onfinish=function(){return w.parentNode&&w.parentNode.removeChild(w)})&&clearTimeout(w.concealTimer)}}),w.addEventListener('click',w.conceal);var x=k({type:'span',id:'ccjmne--google-search-hotkeys--indicator'}),z=k({id:'ccjmne--google-search-hotkeys--help-card',contents:'\n    <div id="ccjmne--google-search-hotkeys--help-card-title">\n        <span>Google Search Hotkeys</span>\n        <small>by&nbsp;<a href="https://github.com/ccjmne">ccjmne</a></small>\n    </div>\n    <table></table>'}),y=z.querySelector('table');[[{desc:'Focus [next] result',hotkey:'Down'},{desc:'Focus [previous] result',hotkey:'Up'},{desc:'Navigate to [next] page',hotkey:'Right'},{desc:'Navigate to [previous] page',hotkey:'Left'}],[{desc:'[Open] focused',hotkey:'Space|Enter'},{desc:'[Open] focused in [new tab]',hotkey:'Ctrl-[Space|Enter]'},{desc:'Open #[1] to #[9]',hotkey:'1..9'},{desc:'Open #[1] to #[9] in [new tab]',hotkey:'Ctrl-[1..9]'}],[{desc:'Focus [search] field',hotkey:'/'},{desc:'Search [all]',hotkey:'a'},{desc:'Search [videos]',hotkey:'v'},{desc:'Search [images]',hotkey:'i'},{desc:'Search [news]',hotkey:'n'}],[{desc:'[Show] help',hotkey:'Shift-?'},{desc:'[Close] help',hotkey:'Escape'}]].forEach(function(a){return a.forEach(function(a,b){return y.appendChild(k({type:'tr',classes:0===b?['ccjmne--google-search-hotkeys--new-section']:[],contents:'\n    <td>'.concat(a.desc.replace(/\[([^\]]+)\]/g,function(a,b){return'<em>'.concat(b,'</em>')}),'</td>\n    <td><kbd>').concat(a.hotkey.replace(/[[\]+|-]|\.\./g,function(a){return'</kbd>'.concat({"..":' to ',"-":'+',"|":' or ',"[":' [',"]":'] '}[a],'<kbd>')}),'</kbd></td>')}))})}),z.addEventListener('click',function(a){return a.stopPropagation()});var A=k({id:'ccjmne--google-search-hotkeys--backdrop',contents:'\n    <div id="ccjmne--google-search-hotkeys--tilt-origin">\n        <div id="ccjmne--google-search-hotkeys--help-shadow"></div>\n        <div id="ccjmne--google-search-hotkeys--help-card-container"></div>\n    </div>'}),B=A.querySelector('#ccjmne--google-search-hotkeys--tilt-origin');A.querySelector('#ccjmne--google-search-hotkeys--help-card-container').appendChild(z),A.addEventListener('click',function(){return l(!1)}),B.addEventListener('mouseleave',function(){return B.style.transform=''}),B.addEventListener('mousemove',t()(function(a){var b=Math.round,c=Math.pow,d=B.getBoundingClientRect(),e=d.left,f=d.top,g=d.right,h=d.bottom,i=a.clientX-(e+g)/2,j=a.clientY-(f+h)/2,k=Math.sqrt(c(i,2)+c(j,2))/r(z.clientWidth,z.clientHeight);B.style.transform='rotate3d('.concat(b(j),', ').concat(-b(i),', 0, ').concat(10*k,'deg)')},100)),x.addEventListener('mouseenter',w.reveal),w.addEventListener('click',function(){return l(!0)}),c(2);var C={27:function(){return l(!1)},65:function(){return window.location.href=d('tbm','')},73:function(){return window.location.href=d('tbm','isch')},77:function(){return null},78:function(){return window.location.href=d('tbm','nws')},86:function(){return window.location.href=d('tbm','vid')}};document.body.onkeydown=function(a){a.srcElement===document.querySelector('input[title=Search]')||a.shiftKey&&!~[32,38,40,191].indexOf(a.keyCode)||a.ctrlKey&&!~[32,38,40].concat(n(Array(9).keys()).map(function(a){return 49+a})).concat(n(Array(9).keys()).map(function(a){return 97+a})).indexOf(a.keyCode)||~[37,38,39,40].indexOf(a.keyCode)&&!~[void 0,null,'','nws','vid'].indexOf(f('tbm'))||function(b){return'function'==typeof b&&Promise.resolve(b(a)).then(function(){return a.preventDefault()})}(C[a.keyCode])},v()('#main a > h3:first-child, #main h3 > a:first-child').then(function(a){var b=this;Object.assign(this,{cur:0<a.length?0:-1,results:[].map.call(a,function(a){return{container:a.parentNode.parentNode,link:a.closest('a')}}),go:function(a){return b.results[b.cur]&&b.results[b.cur].link.dispatchEvent(new MouseEvent('click',a))},focus:function(a){return-1===(b.cur=a)?function(a){a.focus(),a.setSelectionRange(a.value.length,a.value.length),x.detach()}(document.querySelector('input[title=Search]')):function(a){a.link.focus(),a.container.prepend(x),a.container.scrollIntoView({behavior:'smooth',block:'center',inline:'center'}),x.animate([{transform:'translateX(-50px)'},{transform:'translateX(0)'}],{duration:100,easing:'ease-out'})}(b.results[a])}}),this.results.forEach(function(a,b){Object.assign(a.container.style,{position:'relative',overflow:'visible'});var c=k({classes:['ccjmne--google-search-hotkeys--number-indicator'],contents:b+1});c.addEventListener('mouseenter',w.reveal),a.container.prepend(c)}),this.focus(this.cur),n(Array(9).keys()).forEach(function(a){return function(b){var c;return Object.assign(C,(c={},m(c,49+a,b),m(c,97+a,b),c))}(function(c){b.focus(a),b.go(c)})}),Object.assign(C,{32:function(a){return b.go({ctrlKey:a.ctrlKey,shiftKey:a.shiftKey})},191:function(a){return a.shiftKey?l(!0):b.focus(-1)},37:function(){return window.location.replace(d('start',r(parseInt(f('start')||'0')-b.results.length,0)))},38:function(){return b.focus(0<b.cur?b.cur-1:b.results.length-1)},39:function(){return window.location.replace(d('start',parseInt(f('start')||'0')+b.results.length))},40:function(){return b.focus(++b.cur%b.results.length)}})}.bind({}))}]);